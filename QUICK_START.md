# Быстрый старт - Обучение модели детекции СИЗ

## Что детектируем

- **Класс 0: Защитная каска (оранжевая)** - helmet
- **Класс 1: Сигнальный жилет** - vest

## Шаги для полного обучения

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Подготовка данных

Создайте структуру директорий:
```
data/
├── images/
│   ├── train/          # Поместите сюда ВСЕ изображения для обучения
│   └── val/            # Будет создано автоматически
└── labels/
    ├── train/          # Поместите сюда ВСЕ файлы разметки (.txt)
    └── val/            # Будет создано автоматически
```

### 3. Разметка данных

**Важно:** Каждое изображение должно иметь файл разметки с тем же именем и расширением `.txt`

**Формат разметки (YOLO):**
```
class_id center_x center_y width height
```

**Пример файла `image001.txt`:**
```
0 0.5 0.3 0.2 0.25
1 0.7 0.6 0.15 0.2
```

Где:
- `0` = каска (helmet)
- `1` = жилет (vest)
- Все координаты от 0.0 до 1.0 (нормализованные)

**Инструменты для разметки:**
- LabelImg: `pip install labelImg` → `labelImg`
- Roboflow: https://roboflow.com/
- Подробная инструкция: см. `ANNOTATION_GUIDE.md`

### 4. Запуск полного цикла обучения

```bash
python run_training.py
```

Скрипт автоматически:
- ✅ Проверит структуру данных
- ✅ Разделит датасет на train/val (80/20)
- ✅ Запустит обучение модели
- ✅ Сохранит лучшую модель в `models/ppe_model/weights/best.pt`

### 5. Использование обученной модели

```bash
# Детекция на видео
python detect_video.py --video input.mp4 --model models/ppe_model/weights/best.pt

# Детекция с камеры
python detect_camera.py --model models/ppe_model/weights/best.pt
```

## Ручной запуск (если нужно)

### Разделение датасета вручную

```bash
python split_dataset.py --ratio 0.2
```

### Обучение вручную

```bash
python train.py
```

## Структура проекта

```
hahaton123/
├── config/
│   └── ppe_data.yaml          # Конфигурация (2 класса: каска, жилет)
├── data/
│   ├── images/
│   │   ├── train/              # Изображения для обучения
│   │   └── val/                # Изображения для валидации
│   └── labels/
│       ├── train/              # Разметка для обучения (.txt)
│       └── val/                # Разметка для валидации (.txt)
├── models/
│   └── ppe_model/              # Обученные модели (создастся после обучения)
├── run_training.py              # ⭐ Скрипт полного цикла обучения
├── train.py                     # Скрипт обучения
├── split_dataset.py             # Разделение датасета
├── detect_video.py              # Детекция на видео
├── detect_camera.py             # Детекция с камеры
├── README.md                    # Полная документация
├── ANNOTATION_GUIDE.md          # Подробная инструкция по разметке
└── QUICK_START.md               # Этот файл
```

## Требования к данным

- **Минимум:** 100-200 изображений на класс
- **Рекомендуется:** 500+ изображений на класс
- **Формат изображений:** JPG или PNG
- **Разрешение:** 640x640 или выше
- **Разнообразие:** разные углы, освещение, фоны

## Цвета детекции

- **Каска (helmet):** Оранжевый bounding box
- **Жилет (vest):** Желтый bounding box

## Проблемы?

1. **Нет данных?** См. `ANNOTATION_GUIDE.md` - подробная инструкция по разметке
2. **Ошибки при обучении?** Проверьте структуру данных и формат разметки
3. **Плохая точность?** Добавьте больше разнообразных данных

## Полезные команды

```bash
# Проверка структуры данных
python -c "from pathlib import Path; print('Images:', len(list(Path('data/images/train').glob('*.jpg')))); print('Labels:', len(list(Path('data/labels/train').glob('*.txt'))))"

# Просмотр конфигурации
cat config/ppe_data.yaml
```

